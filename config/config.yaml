# ContentForge AI v2.5 - 内容产出工厂配置
# 定位：批量生成技术内容，不包含发布功能

# ==================== LLM配置 ====================
llm:
  provider: "zhipuai"

  # ZhipuAI配置
  zhipuai:
    api_key: "${ZHIPUAI_API_KEY}"
    base_url: "https://open.bigmodel.cn/api/coding/paas/v4/"
    model: "glm-4.7"
    temperature: 0.7
    max_tokens: 8000
    timeout: 600

    thinking:
      enabled: false
      type: "auto"

# ==================== Agent配置 ====================
agents:
  # ========== 核心Agent（每日简报自动生成） ==========
  # AI热点分析Agent（数据获取）
  ai_trend_analyzer:
    enabled: true
    mock_mode: false

    # 数据源配置
    sources:
      - "producthunt"      # Product Hunt RSS
      - "github"           # GitHub Trending
      - "techcrunch_ai"    # TechCrunch AI RSS
      - "verge_ai"         # The Verge AI RSS
      - "venturebeat_ai"   # VentureBeat AI RSS
      - "arxiv_news"       # arXiv API
      - "hackernews"       # Hacker News API

    # 热点配置
    max_trends: 20
    min_heat_score: 60
    cache_ttl: 3600

  # 热点汇总Agent（生成简报）
  trends_digest:
    enabled: true
    style: "magazine"
    include_analysis: true
    max_topics: 20
    temperature: 0.6

  # ========== 内容生成Agent（手动执行） ==========
  # 研究Agent（网络搜索获取技术资料）
  research_agent:
    enabled: true  # 启用，提升长文本质量
    search_provider: "tavily"  # 搜索提供商: zhipuai(推荐,包含在年包中), tavily(付费), mock(离线)
    max_results: 10
    search_depth: "advanced"
    mock_mode: false  # 设为true时不使用任何搜索API

  # 长文本生成Agent（手动：从简报生成长文）
  longform_generator:
    enabled: true  # 启用以生成Series 9和10
    article_length: "long"
    technical_depth: "advanced"
    max_tokens: 8000
    target_word_count: 35000  # 深度技术文章（实际产出30000-40000字符）
    temperature: 0.3  # 降低随机性，提高稳定性

    # 格式修复
    enable_format_fix: true
    remove_duplicate_titles: true
    normalize_headings: true

    # 连贯性
    enable_context_window: true
    max_context_sections: 3

  # 小红书笔记精炼Agent（手动：从简报生成为小红书笔记）
  xiaohongshu_refiner:
    enabled: true  # 启用小红书精炼
    style: "viral"  # viral（爆款风格）, professional, casual
    content_density: "medium"
    max_tokens: 3000
    temperature: 0.8

  # Twitter帖子生成Agent（手动：从简报生成为Twitter）
  twitter_generator:
    enabled: false  # 默认禁用，手动执行时启用
    style: "engaging"
    thread_mode: true
    max_tweets: 5
    max_tokens: 2500
    temperature: 0.9

  # ========== 质量保证Agent（Phase 1新增） ==========
  # 代码审查Agent
  code_review_agent:
    enabled: true  # 启用，确保代码示例正确性
    languages: ["python", "javascript", "typescript", "java", "go", "rust", "cpp", "c"]
    check_syntax: true  # 检查语法正确性
    check_best_practices: true  # 检查最佳实践
    generate_improvements: true  # 生成改进建议

  # 事实核查Agent
  fact_check_agent:
    enabled: true  # 启用，验证事实声明准确性
    confidence_threshold: 0.8  # 置信度阈值
    max_tavily_calls: 10  # 限制Tavily调用次数（控制成本）
    use_tavily: true  # 是否使用Tavily验证关键声明

  # 质量评估Agent
  quality_evaluator_agent:
    enabled: true  # 启用，综合质量评估
    full_evaluation: true  # 完整评估（6个维度）
    generate_improvement: true  # 生成改进建议
    min_score: 7.0  # 质量达标阈值

  # ========== 一致性检查Agent（Phase 2新增） ==========
  # 一致性检查Agent
  consistency_checker_agent:
    enabled: true  # 启用，确保术语、引用、数据一致性
    use_memory_mcp: false  # 是否使用Memory MCP（暂不启用MCP）
    check_terminology: true  # 检查术语一致性
    check_citations: true  # 检查引用完整性
    check_data: true  # 检查数据一致性

  # ========== 可视化生成Agent（Phase 2新增） ==========
  # 可视化生成Agent
  visualization_generator_agent:
    enabled: true  # 启用，自动生成图表
    generate_mermaid: true  # 生成Mermaid图表代码
    min_diagrams: 3  # 最少生成3个图表

  # ========== 引用格式化Agent（Phase 3新增） ==========
  # 引用格式化Agent
  citation_formatter_agent:
    enabled: true  # 启用，统一引用格式
    citation_style: "gb7714"  # 引用格式: gb7714（GB/T 7714-2015）, apa, ieee
    auto_detect: true  # 自动检测引用类型
    generate_reference_list: true  # 自动生成参考文献列表

  # ========== 辅助Agent（可选，提升质量） ==========
  # 标题优化Agent
  title_optimizer:
    enabled: true  # 启用，提升标题质量
    num_titles: 10
    clickbait_level: 0.3
    use_emojis: true

  # 配图提示词生成Agent
  image_generator:
    enabled: true  # 启用，生成配图提示词
    enable_generation: false  # 仅生成提示词
    provider: "gemini"
    model: "gemini-2.0-flash-exp"
    image_size: "1024x1024"
    num_images: 1

# ==================== 工作流配置 ====================
workflow:
  mode: "sequential"
  run_all_agents: true
  save_intermediate_outputs: true
  output_dir: "data/outputs"
  output_formats:
    - "json"
    - "markdown"

# ==================== 提示词配置 ====================
prompts:
  template_file: "config/prompts.yaml"

# ==================== 日志配置 ====================
logging:
  level: "INFO"
  format: "<green>{time:YYYY-MM-DD HH:mm:ss}</green> | <level>{level: <8}</level> | <cyan>{name}</cyan>:<cyan>{function}</cyan> - <level>{message}</level>"
  file:
    enabled: true
    path: "logs/app.log"
    rotation: "100 MB"
    retention: "30 days"
  console:
    enabled: true

# ==================== 缓存配置 ====================
cache:
  enabled: true
  type: "memory"

# ==================== 数据存储配置 ====================
storage:
  # 每日简报存储
  daily:
    dir: "data/daily"
    format: "json"

  # 系列内容存储
  series:
    dir: "data/series"
    format: "json"

# ==================== 开发模式 ====================
development:
  debug: false
  mock_llm: false
  save_all_states: false
  parallel_execution: false

# ==================== 内容工厂模式配置 ====================
content_factory:
  # 每日自动任务
  daily_auto_mode:
    enabled: false  # 通过crontab控制，不在这里配置
    generate_digest_only: true  # 每日自动只生成简报

  # 手动生成任务
  manual_mode:
    # 从简报生成长文本
    digest_to_longform:
      enabled: true
      select_topic: "auto"  # auto=自动选择最热话题, manual=手动选择

    # 从简报生成小红书
    digest_to_xiaohongshu:
      enabled: true
      select_topic: "auto"

    # 从简报生成Twitter
    digest_to_twitter:
      enabled: true
      select_topic: "auto"
